<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>OpenDots</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="header">
        <div class="headerIcons">
            <div class="headerIcon" id="burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <img src="user.png" alt="Logo" class="headerIcon" id="user">
        </div>
        <p>●.◦ OpenDots</p>
    </div>
    <section data-include="configure.html"></section>

</body>
<script>
    async function loadComponents() {
        const elements = document.querySelectorAll("[data-include]");

        for (const el of elements) {
            const file = el.getAttribute("data-include");
            try {
                const res = await fetch(file);
                if (!res.ok) throw new Error(`Failed to load ${file}`);
                const html = await res.text();

                // Insert HTML
                el.innerHTML = html;

                // Re-run scripts inside the loaded content
                const scripts = el.querySelectorAll("script");
                scripts.forEach(oldScript => {
                    const newScript = document.createElement("script");
                    if (oldScript.src) {
                        newScript.src = oldScript.src;  // external script
                    } else {
                        newScript.textContent = oldScript.textContent; // inline script
                    }
                    // copy attributes (async, defer, type, etc.)
                    [...oldScript.attributes].forEach(attr =>
                        newScript.setAttribute(attr.name, attr.value)
                    );
                    oldScript.replaceWith(newScript);
                });
            } catch (err) {
                el.innerHTML = `<p style="color:red;">Error loading ${file}</p>`;
                console.error(err);
            }
        }
    }
    document.addEventListener("DOMContentLoaded", loadComponents);

</script>

</html>